name: Run SAMP Server with Remote.it + DuckDNS + Auto Restart

on:
  workflow_dispatch:  # ูุงุจูุช ุงุฌุฑุง ุฏุณุช
  schedule:
    - cron: "0 */6 * * *"  # ูุฑ ถ ุณุงุนุช ุฎูุฏฺฉุงุฑ ุงุฌุฑุง ูุดู

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: ๐ Checkout Repo
      uses: actions/checkout@v3

    - name: โ๏ธ ูุตุจ ุงุจุฒุงุฑูุง ููุฑุฏ ูุงุฒ
      run: |
        sudo apt update
        sudo apt install -y unzip curl wget

    - name: ๐ฆ ุงุณุชุฎุฑุงุฌ ูุงูโูุง ุณุฑูุฑ
      run: unzip -o LexusRP.zip -d LexusRP

    - name: ๐ ุจุฑูุฒุฑุณุงู ุขโูพ ุฏุฑ DuckDNS
      run: |
        mkdir -p ~/duckdns
        echo "url=https://www.duckdns.org/update?domains=lexusrp&token=af9e1af2-cc2f-433d-816a-8c75fed13594&ip=" > ~/duckdns/duck.conf
        curl -k -o ~/duckdns/duck.log -K ~/duckdns/duck.conf

    - name: โฌ๏ธ ูุตุจ Remote.it CLI
      run: |
        wget https://github.com/remoteit/cli/releases/latest/download/remoteit-linux-x64 -O remoteit
        chmod +x remoteit
        sudo mv remoteit /usr/local/bin/remoteit

    - name: ๐ ูุฑูุฏ ุจู Remote.it
      run: |
        remoteit login --email "parsabakhtazad1@gmail.com" --password "1234567"

    - name: ๐ฅ๏ธ ุงุฌุฑุง ุณุฑูุฑ SAMP
      run: |
        chmod +x LexusRP/LexusRP/sampserver/samp03/samp03svr
        cd LexusRP/LexusRP/sampserver/samp03
        nohup ./samp03svr > server.log 2>&1 &

    - name: ๐ ุซุจุช ูพูุฑุช 7777 ุฏุฑ Remote.it
      run: |
        remoteit add --name "LexusRP SAMP" --port 7777 --type tcp

    - name: โ ููููุช
      run: |
        echo "โ ุณุฑูุฑ ุจุง ููููุช ุฑุงู ุดุฏ ู ุจู Remote.it ูุชุตู ุดุฏ"
        echo "๐ ูุงุฑุฏ ุดูุฏ ุจุง: lexusrp.duckdns.org:7777"
