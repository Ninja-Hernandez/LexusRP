name: Run SAMP Server with Remote.it + DuckDNS

on:
  workflow_dispatch:
  schedule:
    - cron: "0 */6 * * *"  # Ù‡Ø± Û¶ Ø³Ø§Ø¹Øª ÛŒÚ©Ø¨Ø§Ø± Ø³Ø±ÙˆØ± Ø®ÙˆØ¯Ú©Ø§Ø± Ø§Ø¬Ø±Ø§ Ø´ÙˆØ¯

jobs:
  run-samp-server:
    runs-on: ubuntu-latest

    steps:
    - name: ðŸ“¥ Ø¯Ø±ÛŒØ§ÙØª ÙØ§ÛŒÙ„ Ù…Ø®Ø²Ù†
      uses: actions/checkout@v3

    - name: ðŸ§© Ù†ØµØ¨ Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ù„Ø§Ø²Ù…
      run: |
        sudo apt update
        sudo apt install -y unzip curl wget

    - name: ðŸ“¦ Ø§Ø³ØªØ®Ø±Ø§Ø¬ ÙØ§ÛŒÙ„ Ø³Ø±ÙˆØ±
      run: unzip -o LexusRP.zip -d LexusRP

    - name: ðŸŒ Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¢ÛŒâ€ŒÙ¾ÛŒ Ø¯Ø± DuckDNS
      run: |
        mkdir -p ~/duckdns
        echo "url=https://www.duckdns.org/update?domains=lexusrp&token=af9e1af2-cc2f-433d-816a-8c75fed13594&ip=" > ~/duckdns/duck.conf
        curl -k -o ~/duckdns/duck.log -K ~/duckdns/duck.conf

    - name: ðŸ”Œ Ø§ØªØµØ§Ù„ Ø¨Ù‡ Remote.it
      run: |
        wget https://downloads.remote.it/remoteit/install.sh
        chmod +x install.sh
        sudo ./install.sh
        remoteit login Parsabakhtazad1@gmail.com --create-token
        remoteit add --name "LexusSAMP" --port 7777 --type tcp --force

    - name: ðŸš€ Ø§Ø¬Ø±Ø§ÛŒ Ø³Ø±ÙˆØ± SAMP
      run: |
        chmod +x LexusRP/LexusRP/sampserver/samp03/samp03svr
        cd LexusRP/LexusRP/sampserver/samp03
        nohup ./samp03svr > server.log 2>&1 &

    - name: âœ… Ù¾Ø§ÛŒØ§Ù† Ø³Ø±ÛŒØ¹
      run: echo "âœ… Server started successfully at http://lexusrp.duckdns.org:7777"
