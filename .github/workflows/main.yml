name: Run SA-MP Server - LexusRP

on:
  workflow_dispatch:

jobs:
  start-server:
    runs-on: ubuntu-latest

    steps:
    - name: ๐ฅ ฺฉููู ฺฉุฑุฏู ูุงูโูุง
      uses: actions/checkout@v3

    - name: โ๏ธ ูุตุจ ฺฉุชุงุจุฎุงููโูุง ููุฑุฏูุงุฒ
      run: |
        sudo apt update
        sudo apt install -y lib32z1 lib32gcc-s1 unzip curl wget

    - name: ๐ฆ ุงุณุชุฎุฑุงุฌ ูุงู ุฒูพ ุณุฑูุฑ
      run: |
        unzip -o LexusRP.zip -d LexusRP

    - name: ๐ ุจุฑุฑุณ ูุฌูุฏ samp03svr ู ุงุฌุฑุง ุขู
      run: |
        cd LexusRP/LexusRP
        echo "๐ ูุณุฑ ูุนู:"
        pwd

        echo "๐ ูุณุช ูุงูโูุง:"
        ls -la

        if [ -f "samp03svr" ]; then
          echo "โ samp03svr ูพุฏุง ุดุฏ"
          chmod +x samp03svr
          ./samp03svr > server.log 2>&1 &
          sleep 10

          echo "๐ ฒฐ ุฎุท ุขุฎุฑ ูุงฺฏ:"
          tail -n 20 server.log

          if grep -i "started" server.log; then
            echo "โ ุณุฑูุฑ ุจุง ููููุช ุงุฌุฑุง ุดุฏ!"
          else
            echo "โ๏ธ ุณุฑูุฑ ุงุฌุฑุง ูุดุฏุ ูุทูุงู ูุงฺฏ ุฑุง ุจุฑุฑุณ ฺฉู"
          fi
        else
          echo "โ ูุงู samp03svr ูพุฏุง ูุดุฏ"
          ls -la
          exit 1
        fi
