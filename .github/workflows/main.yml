name: Run SAMP Server with DuckDNS

on:
  workflow_dispatch:
  schedule:
    - cron: "0 */6 * * *"  # هر 6 ساعت اجرا میشه

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v3

    - name: Install dependencies
      run: sudo apt update && sudo apt install -y unzip curl screen

    - name: Unzip Server
      run: unzip -o LexusRP.zip -d LexusRP

    - name: Update DuckDNS IP
      run: |
        curl -k "https://www.duckdns.org/update?domains=lexusrp&token=af9e1af2-cc2f-433d-816a-8c75fed13594&ip="

    - name: Run SAMP Server
      run: |
        chmod +x LexusRP/LexusRP/sampserver/samp03/samp03svr
        screen -dmS sampserver bash -c "cd LexusRP/LexusRP/sampserver/samp03 && ./samp03svr"

    - name: Done
      run: echo "✅ Server started on LexusRP.duckdns.org:7777"
